{"version":3,"file":"matrixExtendedJs-2d5946fe.js","sources":["../../../../../static/src/js/matrixExtended.ts"],"sourcesContent":["(function (window: any) {\n    const {Craft, Garnish, $} = window;\n    if (!Craft || !Garnish || !$) {\n        return;\n    }\n\n    /**\n     * @see https://github.com/craftcms/cms/blob/5.x/src/web/assets/matrix/src/MatrixInput.js\n     * @todo check, that it only initializes on Inline Editable views\n     */\n    Craft.MatrixExtended = Garnish.Base.extend({\n        settings: {}, childParent: {}, helper: undefined, itemDrag: undefined, $trigger: undefined,\n\n        init: function (config: { settings: any, childParent: any }, helper: any) {\n            const self = this;\n            this.settings = config.settings || {};\n            this.childParent = config.childParent || {};\n            this.helper = helper;\n\n            if (!Garnish.DisclosureMenu || !Craft.MatrixInput) {\n                return;\n            }\n\n            const disclosureMenuShowFn = Garnish.DisclosureMenu.prototype.show;\n            Garnish.DisclosureMenu.prototype.show = function (...args: any[]) {\n                self.initDisclosureMenu(this);\n                disclosureMenuShowFn.apply(this, args);\n            };\n\n            const disclosureMenuInitFn = Garnish.DisclosureMenu.prototype.init;\n            Garnish.DisclosureMenu.prototype.init = function (...args: any[]) {\n                disclosureMenuInitFn.apply(this, args);\n                self.initAddButtonMenu(this);\n                self.prepareEntryDropZones();\n            };\n\n            const matrixUpdateAddEntryBtnFn = Craft.MatrixInput.prototype.updateAddEntryBtn;\n            Craft.MatrixInput.prototype.updateAddEntryBtn = function (...args: any[]) {\n                matrixUpdateAddEntryBtnFn.apply(this, args);\n                self.checkAddBtn(this);\n            };\n\n            if (!this.settings.enableDragDrop) {\n                return;\n            }\n\n            const matrixInitFn = Craft.MatrixInput.prototype.init;\n            Craft.MatrixInput.prototype.init = function (...args: any[]) {\n                matrixInitFn.apply(this, args);\n                this.entrySort.allowDragging = () => false;\n                this.entrySort.destroy();\n                self.prepareEntryDropZones();\n            };\n\n            Craft.MatrixInput.prototype.canAddMoreEntries = function () {\n                return (\n                    !this.maxEntries ||\n                    this.$entriesContainer.children(':not(.matrix-extended-drop-target):not(.matrix-extended-buttons)').length < this.maxEntries\n                );\n            };\n\n            const matrixCanPasteFn = Craft.MatrixInput.prototype.canPaste;\n            Craft.MatrixInput.prototype.canPaste = function (elementInfo: any) {\n                if (!elementInfo?.length) {\n                    return false;\n                }\n\n                return matrixCanPasteFn.apply(this, [elementInfo]);\n            };\n\n            const matrixUpdatePasteBtnFn = Craft.MatrixInput.prototype.updatePasteBtn;\n            Craft.MatrixInput.prototype.updatePasteBtn = function (elementInfo?: any) {\n                elementInfo = elementInfo || Craft.cp.getCopiedElements();\n\n                matrixUpdatePasteBtnFn.apply(this, [elementInfo]);\n            };\n\n            const $fields = $('.matrix-field');\n            const $blocks = $fields.find('.matrixblock');\n            for (const block of $blocks) {\n                const $block = $(block);\n\n                $block.find('> .actions > .move-btn').remove();\n                $block.find('> .actions').append('<div class=\"chromeless small move\"><div class=\"inline-flex\"><div class=\"cp-icon\"><svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 448 512\" focusable=\"false\" aria-hidden=\"true\"><path d=\"M71.3 295.6c-21.9-21.9-21.9-57.3 0-79.2s57.3-21.9 79.2 0 21.9 57.3 0 79.2s-57.4 21.9-79.2 0zM184.4 182.5c-21.9-21.9-21.9-57.3 0-79.2s57.3-21.9 79.2 0 21.9 57.3 0 79.2-57.3 21.8-79.2 0zm0 147c21.9-21.9 57.3-21.9 79.2 0s21.9 57.3 0 79.2s-57.3 21.9-79.2 0c-21.9-21.8-21.9-57.3 0-79.2zM297.5 216.4c21.9-21.9 57.3-21.9 79.2 0s21.9 57.3 0 79.2s-57.3 21.9-79.2 0c-21.8-21.9-21.8-57.3 0-79.2z\"></path></svg></div></div></div>');\n            }\n\n\n            this.itemDrag = new Garnish.DragDrop({\n                activeDropTargetClass: 'active',\n                minMouseDist: 10,\n                hideDraggee: false,\n                moveHelperToCursor: true,\n                handle: (item: any) => $(item).find('> .actions > .move, > .titlebar'),\n                filter: () => this.itemDrag.$targetItem.closest('.matrixblock'),\n                dropTargets: () => {\n                    if (!this.childParent) {\n                        return [];\n                    }\n\n                    const {entry, typeId} = this.itemDrag.$draggee.closest('.matrixblock').data();\n                    const matrix = entry.matrix;\n                    if (!matrix || !typeId) {\n                        return [];\n                    }\n                    // TODO check `canAddMore`, but only if drag and drop is between fields\n                    // const $allDropTargets = $('.matrix-extended-drop-target').filter((_, x) => !!$(x).data('canAddMore'));\n                    const $allDropTargets = $('.matrix-extended-drop-target')\n                        .filter((_: any, x: any) => (this.childParent[typeId] || []).includes($(x).data('entryTypeId')));\n\n                    return $allDropTargets.toArray().reverse();\n                },\n                onDragStart: () => {\n                    Garnish.$bod.addClass('dragging');\n                    this.itemDrag.$draggee.closest('.matrixblock').addClass('draggee');\n                    this.$dropEntry = this.itemDrag.$draggee.data('entry').$container;\n                    this.$pullBlock = this.$dropEntry.closest('.matrix-field');\n                },\n                // TODO find better way, like changing the owner. Currently clone & delete is used\n                onDragStop: async () => {\n                    this.itemDrag.$draggee.closest('.matrixblock').removeClass('draggee');\n                    Garnish.$bod.removeClass('dragging');\n                    if (!this.$dropEntry || !this.$pullBlock) {\n                        return this.itemDrag.returnHelpersToDraggees();\n                    }\n                    const $dropEntry = this.$dropEntry;\n                    const $dropTarget = this.itemDrag.$activeDropTarget;\n\n                    if (!$dropEntry || !$dropTarget) {\n                        return this.itemDrag.returnHelpersToDraggees();\n                    }\n\n                    let $relationEntry;\n                    let relationPosition = 'insertBefore';\n                    if ($dropTarget.data('position') === 'button') {\n                        $relationEntry = $dropTarget.closest('.matrix-field').find('> .blocks');\n                        relationPosition = 'appendTo';\n                    } else {\n                        $relationEntry = $dropTarget.next('.matrixblock');\n                    }\n\n                    const $pullBlock = this.$pullBlock;\n                    const $dropBlock = $dropTarget.closest('.matrix-field');\n                    if ($pullBlock.is($dropBlock)) {\n                        if (relationPosition === 'appendTo') {\n                            $dropEntry.appendTo($relationEntry);\n                        } else {\n                            $dropEntry.insertBefore($relationEntry);\n                        }\n\n                        // only update one block\n                        $pullBlock.data('matrix').entrySelect.resetItemOrder();\n                    } else {\n                        const matrix = $dropBlock.data('matrix');\n                        const matrix2 = $pullBlock.data('matrix');\n                        const entry = $dropEntry.data('entry');\n                        const typeId = $dropEntry.data('typeId');\n                        await this.duplicateWithNewOwner($relationEntry, relationPosition, typeId, entry, matrix, matrix2)\n                        // matrix.entrySelect.resetItemOrder();\n                        // matrix2.entrySelect.resetItemOrder();\n                    }\n\n                    this.itemDrag.returnHelpersToDraggees();\n                    this.prepareEntryDropZones();\n                    this.$dropEntry = undefined;\n                    this.$pullBlock = undefined;\n                },\n            });\n        },\n\n        prepareEntryDropZones() {\n            if (!this.settings.experimentalFeatures || !this.settings.enableDragDrop) {\n                return;\n            }\n\n            const $fields = $('.matrix-field');\n            const $blocks = $fields.find('.matrixblock');\n\n            $('.matrix-extended-drop-target').remove();\n            for (const block of $blocks) {\n                const $block = $(block);\n\n                let $entryTypeId = null;\n                const entry = $block.data('entry');\n                if (!entry) {\n                    return;\n                }\n                const matrix = entry.matrix;\n                if (!matrix) {\n                    return;\n                }\n\n                $entryTypeId = matrix.settings.fieldId;\n\n                const $dropTargetBefore = $(`<div class=\"matrix-extended-drop-target\" data-position=\"block\"><div></div></div>`);\n                $dropTargetBefore.data($block.data());\n                $dropTargetBefore.data('entryTypeId', $entryTypeId);\n                $block.before($dropTargetBefore);\n            }\n\n            const $buttons = $fields.find('> .buttons');\n            for (const button of $buttons) {\n                const $button = $(button);\n\n                const matrix = $button.closest('.matrix-field').data('matrix');\n                if (!matrix) {\n                    continue;\n                }\n\n                const $dropTargetButton = $(`<div class=\"matrix-extended-drop-target\" data-position=\"button\"><div></div></div>`);\n                $dropTargetButton.data('entryTypeId', matrix.settings.fieldId);\n                $dropTargetButton.insertBefore($button);\n            }\n\n            this.itemDrag.removeAllItems();\n            this.itemDrag.addItems($blocks);\n            Garnish.$bod.addClass('matrix-extended-drag-drop');\n        },\n\n        initAddButtonMenu(disclosureMenu: any) {\n            const {$trigger, $container} = disclosureMenu;\n            const $parent = $trigger.parent();\n            const $nativeButtonContainer = $trigger.closest('.buttons');\n            const $wrapper = $nativeButtonContainer.parent('.matrix-field');\n            if (!$trigger || !$container || !$parent.hasClass('buttons') || !$wrapper.attr('id')) {\n                return;\n            }\n\n            if ($trigger._hasMatrixExtensionButtonsInitialized) {\n                return;\n            }\n            $trigger._hasMatrixExtensionButtonsInitialized = true;\n            this.$trigger = $trigger;\n\n            if (!this.settings.expandMenu) {\n                return;\n            }\n\n            $trigger.hide();\n            const $buttonContainer = $('<div class=\"buttons matrix-extended-buttons\"></div>');\n            const $actionButtons = $trigger\n                .disclosureMenu()\n                .data('disclosureMenu')\n                .$container.find('button')\n                .clone()\n                .off()\n                .on('activate', async (ev: any) => {\n                    const $button = $container.find('button').filter((_: any, x: any) => $(x).data('type') === $(ev.currentTarget).data('type'));\n                    $button.trigger('activate');\n                });\n\n            const id = $wrapper.attr('id');\n            this.buildGroupedMenu($buttonContainer, $actionButtons, $trigger, id);\n\n            $buttonContainer.appendTo($parent);\n        },\n\n        initDisclosureMenu(disclosureMenu: any) {\n            const {$trigger, $container} = disclosureMenu;\n            if (!$trigger || !$container || !$trigger.hasClass('action-btn')) {\n                return;\n            }\n            const $element = $trigger.closest('.actions').parent('.matrixblock');\n            if (!$element.length) {\n                return;\n            }\n            const {typeId, entry} = $element.data();\n            if (!typeId || !entry) {\n                return;\n            }\n\n            const matrix = entry.matrix;\n            if (!matrix) {\n                return;\n            }\n\n            if (disclosureMenu._hasMatrixExtensionButtonsInitialized) {\n                this.checkAdd($container, matrix);\n                return;\n            }\n            disclosureMenu._hasMatrixExtensionButtonsInitialized = true;\n\n            this.addMenu($container, typeId, entry, matrix);\n        },\n\n        duplicateWithNewOwner: async function ($relationEntry: any, relationPosition: any, typeId: any, entry: any, matrix: any, matrix2: any) {\n            if (matrix.addingEntry) {\n                // only one new entry at a time\n                return;\n            }\n\n            if (!matrix.canAddMoreEntries()) {\n                matrix.updateStatusMessage();\n                return;\n            }\n\n            matrix.addingEntry = true;\n\n            if (matrix.elementEditor) {\n                // First ensure we're working with drafts for all elements leading up\n                // to this fieldâ€™s element\n                await matrix.elementEditor.setFormValue(matrix.settings.baseInputName, '*');\n            }\n\n            try {\n                const entryId = matrix.elementEditor.getDraftElementId(entry.id);\n\n                const {data} = await Craft.sendActionRequest('POST', 'matrix-extended/matrix-extended/duplicate-entry-with-new-owner', {\n                    data: {\n                        fieldId: matrix.settings.fieldId,\n                        entryId,\n                        entryTypeId: typeId,\n                        ownerId: matrix.settings.ownerId,\n                        ownerElementType: matrix.settings.ownerElementType,\n                        siteId: matrix.settings.siteId,\n                        namespace: matrix.settings.namespace,\n                        staticEntries: matrix.settings.staticEntries,\n                    },\n                });\n\n                const $entry = $(data.blockHtml);\n\n                // Pause the element editor\n                matrix.elementEditor?.pause();\n\n                if (relationPosition === 'appendTo') {\n                    $entry.appendTo($relationEntry);\n                } else {\n                    $entry.insertBefore($relationEntry);\n                }\n                entry.$container.hide();\n\n                matrix.trigger('entryAdded', {\n                    $entry: $entry,\n                });\n\n                $entry.css('margin-bottom', '');\n                Craft.initUiElements($entry.children('.fields'));\n                await Craft.appendHeadHtml(data.headHtml);\n                await Craft.appendBodyHtml(data.bodyHtml);\n                new Craft.MatrixInput.Entry(matrix, $entry);\n                matrix.entrySort.addItems($entry);\n                matrix.entrySelect.addItems($entry);\n                matrix.updateAddEntryBtn();\n\n                // Animate the entry into position\n                $entry.css(matrix.getHiddenEntryCss($entry)).velocity({\n                    opacity: 1, 'margin-bottom': 10,\n                }, 'fast',);\n\n                Garnish.requestAnimationFrame(function () {\n                    // Resume the element editor\n                    matrix.elementEditor?.resume();\n                    entry.selfDestruct();\n                });\n            } catch (error) {\n                this.addStatusMessage(Craft.t('matrix-extended', 'There was an error dropping the entry'), 'error');\n            }\n\n            matrix.addingEntry = false;\n            entry.actionDisclosure.hide();\n        },\n\n        addMenu: function ($container: any, typeId: any, entry: any, matrix: any) {\n            const $menu = $('<ul class=\"matrix-extended\"></ul>');\n            const $hr = $('<hr class=\"padded\">');\n\n            this.addAddBlockButton($menu, typeId, entry, matrix);\n            this.checkAdd($menu, matrix);\n\n            $menu.insertBefore($container.find('ul').eq(0));\n            $hr.insertAfter($menu);\n\n            if (this.settings.removeEntryTypesFromDiscloseMenu) {\n                const $addButtonContainer = $container.find('[data-action=\"add\"]').parent().parent();\n                $addButtonContainer.prev().hide();\n                $addButtonContainer.hide();\n            }\n        },\n\n        addAddBlockButton: function ($menu: any, _: any, entry: any, matrix: any) {\n            if (!this.settings.enableAddBlockAbove) {\n                return;\n            }\n\n            if (!matrix.$addEntryMenuBtn.length && !matrix.$addEntryBtn.length) {\n                return;\n            }\n\n            const $addBlockButton = $(`<li>\n                    <button class=\"menu-item\" data-action=\"add-block\" tabindex=\"0\">\n                        <span class=\"icon\">\n                            <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 448 512\"><!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path d=\"M64 80c-8.8 0-16 7.2-16 16V416c0 8.8 7.2 16 16 16H384c8.8 0 16-7.2 16-16V96c0-8.8-7.2-16-16-16H64zM0 96C0 60.7 28.7 32 64 32H384c35.3 0 64 28.7 64 64V416c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V96zM200 344V280H136c-13.3 0-24-10.7-24-24s10.7-24 24-24h64V168c0-13.3 10.7-24 24-24s24 10.7 24 24v64h64c13.3 0 24 10.7 24 24s-10.7 24-24 24H248v64c0 13.3-10.7 24-24 24s-24-10.7-24-24z\"/></svg>\n                        </span><span class=\"menu-item-label\">${Craft.t('matrix-extended', 'Add block above')}</span>\n                    </button>\n                </li>`);\n            $menu.append($addBlockButton);\n\n            $addBlockButton.on('click', 'button[data-action=\"add-block\"]', () => {\n                const id = matrix.id;\n\n                $('.matrix-extended-buttons-above').remove();\n\n                const $actionsContainer = entry && entry.actionDisclosure && entry.actionDisclosure.$container\n                    ? entry.actionDisclosure.$container\n                    : null;\n\n                if (!$actionsContainer) {\n                    return;\n                }\n\n                const $nativeButtons = $actionsContainer.find('[data-action=\"add\"]');\n                if (!$nativeButtons.length) {\n                    return;\n                }\n\n                const $buttonContainer = $('<div class=\"buttons matrix-extended-buttons matrix-extended-buttons-above\"></div>');\n\n                // Create proxy buttons by cloning visuals only; forward activation to native buttons\n                const $proxyButtons = $nativeButtons\n                    .clone()\n                    .off()\n                    .on('activate', (ev: any) => {\n                        const type = $(ev.currentTarget).data('type');\n                        const $orig = $nativeButtons.filter((_: any, x: any) => $(x).data('type') === type);\n                        if ($orig.length) {\n                            $orig.trigger('activate');\n                        }\n                        setTimeout(() => $buttonContainer.remove(), 0);\n                    });\n\n                $proxyButtons.each((_: number, btn: any) => {\n                    const $btn = $(btn);\n                    const $actions = this.$trigger.disclosureMenu()\n                        .data('disclosureMenu').$container;\n\n                    const label = $actions.find('[data-type=\"' + $btn.data('type') + '\"]').text();\n                    if (label) {\n                        $(btn).text(label)\n                    } else {\n                        $(btn).text($(btn).text())\n                    }\n                });\n\n\n                if (this.settings.expandMenu) {\n                    this.buildGroupedMenu($buttonContainer, $proxyButtons, matrix.$addEntryMenuBtn, id, true);\n                    matrix.updatePasteBtn();\n                } else {\n                    const baseLabel = matrix.$addEntryMenuBtn.find('.label').text();\n\n                    const plainMenuId = `matrix-extended-menu-${id}-all`;\n                    $(`#${plainMenuId}`).remove();\n\n                    const $menubtn = Craft.ui\n                        .createButton({label: baseLabel, spinner: true})\n                        .addClass('btn menubtn dashed add icon')\n                        .attr('aria-controls', plainMenuId)\n                        .appendTo($buttonContainer);\n\n                    const $menuContainer = $(`<div class=\"menu menu--disclosure mx-no-focus\" id=\"${plainMenuId}\">`);\n                    const $menu = $('<ul></ul>');\n                    $menuContainer.append($menu);\n                    $(document.body).append($menuContainer);\n\n                    const disclosure = new Garnish.DisclosureMenu($menubtn);\n\n                    $proxyButtons.each((_: number, btn: any) => {\n                        const $li = $('<li></li>');\n                        const $b = $(btn);\n                        $li.append($b);\n                        $menu.append($li);\n                        $b.on('activate', () => {\n                            $menuContainer.remove();\n                            disclosure.destroy();\n                            setTimeout(() => $buttonContainer.remove(), 0);\n                        });\n                    });\n                }\n\n                $buttonContainer.insertBefore(entry.$container);\n                if (entry.actionDisclosure) {\n                    entry.actionDisclosure.hide();\n                }\n            });\n        },\n\n        buildGroupedMenu: function ($buttonContainer: any, $actionButtons: any, $actionBtn: any, id: any, above = false) {\n            const fieldIndex: string = id.replace(/.*fields-/, '');\n            let $unused = $actionButtons;\n            if (!this.settings.fields) {\n                const $actionButtonContainer = $('<div class=\"btngroup matrix-extended-btngroup\"></div>')\n                $unused.first().addClass('add icon');\n                $unused.addClass('btn dashed');\n                $actionButtonContainer.append($unused);\n                $buttonContainer.append($actionButtonContainer)\n                return;\n            }\n\n            if (!this.settings.fields[fieldIndex]) {\n                const $actionButtonContainer = $('<div class=\"btngroup matrix-extended-btngroup\"></div>')\n                $unused.first().addClass('add icon');\n                $unused.addClass('btn dashed');\n                $actionButtonContainer.append($unused);\n                $buttonContainer.append($actionButtonContainer)\n                return;\n            }\n\n            const fieldGroup: Record<string, { groups: any, oneLiner: boolean }> = this.settings.fields[fieldIndex];\n            if (fieldGroup.oneLiner) {\n                $buttonContainer.addClass('one-line');\n            }\n            for (const [index, group] of Object.entries(fieldGroup.groups)) {\n                $(`#matrix-extended-menu-${id}-${index}${above ? '-above' : ''}`).remove();\n\n                const $groupedMenuButton = Craft.ui\n                    .createButton({\n                        label: group.label, spinner: true,\n                    })\n                    .addClass('btn menubtn dashed add icon')\n                    .attr('aria-controls', `matrix-extended-menu-${id}-${index}${above ? '-above' : ''}`)\n                    .appendTo($buttonContainer);\n                const $menuContainer = $(`<div class=\"menu menu--disclosure\" id=\"matrix-extended-menu-${id}-${index}${above ? '-above' : ''}\">`);\n                const $menu = $('<ul></ul>');\n\n                $menuContainer.append($menu);\n                $(document.body).append($menuContainer);\n                const disclosure = new Garnish.DisclosureMenu($groupedMenuButton);\n\n                for (const type of group.types) {\n                    const $li = $(`<li></li>`);\n                    const $button = $actionButtons.filter((_: any, x: any) => $(x).data('type') === type);\n                    $unused = $unused.filter((_: any, x: any) => $(x).data('type') !== type);\n                    if (!$button.length) {\n                        console.warn(`Type ${type} not found in group ${id}`)\n                        continue;\n                    }\n                    $li.append($button);\n                    $menu.append($li);\n                    $button.on('activate', () => {\n                        if (!above) {\n                            disclosure.hide();\n                            return;\n                        }\n                        $menuContainer.remove();\n                        disclosure.destroy();\n                    });\n                }\n            }\n\n            if (!$unused.length) {\n                return;\n            }\n\n            if (this.settings.expandUngrouped) {\n                const $actionButtonContainer = $('<div class=\"btngroup matrix-extended-btngroup\"></div>')\n                $unused.first().addClass('add icon');\n                $unused.addClass('btn dashed');\n                $actionButtonContainer.append($unused);\n\n                switch (this.settings.ungroupedPosition) {\n                    case 'start':\n                        $buttonContainer.prepend($actionButtonContainer);\n                        break;\n                    case 'end':\n                        $buttonContainer.append($actionButtonContainer);\n                        break;\n                }\n                return;\n            }\n\n            $(`#matrix-extended-menu-${id}-others${above ? '-above' : ''}`).remove();\n            const $groupedMenuButton = Craft.ui\n                .createButton({\n                    label: $actionBtn.find('.label').text(), spinner: true,\n                })\n                .addClass('btn menubtn dashed add icon')\n                .attr('aria-controls', `matrix-extended-menu-${id}-others${above ? '-above' : ''}`);\n\n            switch (this.settings.ungroupedPosition) {\n                case 'start':\n                    $groupedMenuButton.prependTo($buttonContainer);\n                    break;\n                case 'end':\n                    $groupedMenuButton.appendTo($buttonContainer);\n                    break;\n            }\n\n            const $menuContainer = $(`<div class=\"menu menu--disclosure\" id=\"matrix-extended-menu-${id}-others${above ? '-above' : ''}\">`);\n            const $menu = $('<ul></ul>');\n\n            $menuContainer.append($menu);\n            $(document.body).append($menuContainer);\n            const disclosure = new Garnish.DisclosureMenu($groupedMenuButton);\n\n            for (const button of $unused) {\n                const $li = $(`<li></li>`);\n                const $button = $(button);\n                $li.append($button);\n                $menu.append($li);\n                $button.on('activate', () => {\n                    if (!above) {\n                        disclosure.hide();\n                        return;\n                    }\n                    $menuContainer.remove();\n                    disclosure.destroy();\n                })\n            }\n        },\n\n        checkAdd: function ($container: any, matrix: any) {\n            const $addButton = $container.find('button[data-action=\"add-block\"]');\n            $addButton.disable();\n            const $parent = $addButton.parent();\n            $parent.attr('title', '');\n\n            if (!matrix.canAddMoreEntries()) {\n                $parent.attr('title', Craft.t('matrix-extended', 'No more entries can be added.'));\n                return;\n            }\n\n            $addButton.enable();\n        },\n\n        checkAddBtn: function (matrix: any) {\n            if (!this.settings.expandMenu) {\n                return;\n            }\n\n            const $btns = matrix.$container.find('> .blocks > .matrix-extended-buttons, > .buttons > .matrix-extended-buttons').find('button');\n            $btns.disable();\n            const $parent = $btns.parent();\n            $parent.attr('title', '');\n\n            if (!matrix.canAddMoreEntries()) {\n                $parent.attr('title', Craft.t('matrix-extended', 'No more entries can be added.'));\n                return;\n            }\n\n            $btns.enable();\n        },\n\n        addStatusMessage: function (message: string, type: 'notice' | 'error' = 'notice') {\n            if (type === 'notice') {\n                Craft.cp.displayNotice(message);\n            }\n\n            if (type === 'error') {\n                Craft.cp.displayError(message);\n            }\n        }\n    });\n})(window);\n"],"names":["window","Craft","Garnish","$","config","helper","self","disclosureMenuShowFn","args","disclosureMenuInitFn","matrixUpdateAddEntryBtnFn","matrixInitFn","matrixCanPasteFn","elementInfo","matrixUpdatePasteBtnFn","$blocks","block","$block","item","entry","typeId","_","x","$dropEntry","$dropTarget","$relationEntry","relationPosition","$pullBlock","$dropBlock","matrix","matrix2","$fields","$entryTypeId","$dropTargetBefore","$buttons","button","$button","$dropTargetButton","disclosureMenu","$trigger","$container","$parent","$wrapper","$buttonContainer","$actionButtons","ev","id","$element","_a","entryId","data","$entry","$menu","$hr","$addButtonContainer","$addBlockButton","$actionsContainer","$nativeButtons","$proxyButtons","type","$orig","btn","$btn","label","baseLabel","plainMenuId","$menubtn","$menuContainer","disclosure","$li","$b","$actionBtn","above","fieldIndex","$unused","$actionButtonContainer","fieldGroup","index","group","$groupedMenuButton","$addButton","$btns","message"],"mappings":"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"}